(this["webpackJsonptableau-extension-exportall"]=this["webpackJsonptableau-extension-exportall"]||[]).push([[0],{215:function(e,t){},222:function(e){e.exports=JSON.parse('{"name":"tableau-extension-exportall","version":"2.3.1","private":true,"homepage":"..","dependencies":{"@material-ui/core":"^4.11.3","@material-ui/icons":"^4.11.2","@tableau/tableau-ui":"^3.2.0","compare-versions":"^3.6.0","file-saver":"^2.0.5","react":"^17.0.1","react-app-polyfill":"^2.0.0","react-dom":"^17.0.1","react-router-dom":"^5.2.0","react-scripts":"4.0.1","xlsx":"^0.16.9"},"scripts":{"start":"react-scripts start","build":"react-scripts build","release":"react-scripts build && copyfiles -f ./build/index.html ./build/configure && copyfiles -f ./build/index.html ./build/desktopexport","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all","IE 10"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"copyfiles":"^2.4.1","typescript":"^4.1.3"}}')},437:function(e,t,n){},443:function(e,t){},444:function(e,t){},452:function(e,t,n){},453:function(e,t,n){},454:function(e,t,n){},456:function(e,t,n){"use strict";n.r(t);var a=n(2),s=(n(237),n(247),n(0)),o=n.n(s),l=n(46),i=n.n(l),r=(n(437),n(22)),c=n(217),u=n(218),d=n(226),g=n(224),h=n(223),b=n(19),f=n(21);var m=function(e){return Object(a.jsx)("div",{children:Object(a.jsx)(f.Button,{kind:e.style,disabled:e.disabled,onClick:e.export,children:e.label})})},j=n(94),p=n.n(j),x=n(219);var v=function(){return new Promise((function(e,t){console.log("[func.js] Saving settings"),tableau.extensions.settings.set("metaVersion",2),console.log("[func.js] Authoring mode",tableau.extensions.environment.mode),"authoring"===tableau.extensions.environment.mode?tableau.extensions.settings.saveAsync().then((function(t){e(t)})).catch(t):e()}))},O=function(e,t){return new Promise((function(n,a){console.log("[func.js] Set settings",e,t);var s="";switch(e){case"sheets":s="selectedSheets";break;case"label":s="buttonLabel";break;case"style":s="buttonStyle";break;case"filename":s="filename";break;case"version":s="metaVersion";break;default:s="unknown"}tableau.extensions.settings.set(s,JSON.stringify(t)),n()}))},S=function(e,t,n){return new Promise((function(a,s){e.getSummaryDataAsync({ignoreSelection:!0}).then((function(e){console.log("[func.js] getSheetColumns existingCols",JSON.stringify(t));var s=e.columns,o=[],l=[];if(n){for(var i=0;i<s.length;i++){var c={};c.index=s[i].index,c.name=s[i].fieldName,c.dataType=s[i].dataType,c.changeName=null,c.selected=!1,o.push(c)}for(var u=0;u<t.length;u++)t[u]&&t[u].hasOwnProperty("name")&&l.push(t[u].name);console.log("[func.js] getSheetColumns existingIdx",l);var d=l.length;o=o.map((function(e,n){var a=l.indexOf(e.name),s=Object(r.a)({},e);return a>-1?(s.selected=t[a].selected,s.changeName=t[a].changeName,s.order=a):(s.order=d,d+=1),s}))}else for(var g=0;g<s.length;g++){var h={};h.index=s[g].index,h.name=s[g].fieldName,h.dataType=s[g].dataType,h.selected=!0,h.order=g+1,o.push(h)}o=o.sort((function(e,t){return e.order>t.order?1:-1})),a(o)})).catch((function(t){console.log("[func.js] Error with getSummaryDataAsync",e,t)}))}))},y=function(){return new Promise((function(e,t){console.log("[func.js] Initialise Meta");var n=[],a=tableau.extensions.dashboardContent._dashboard.worksheets.map((function(e){var t=e,a={};return a.sheetName=t.name,a.selected=!1,a.changeName=null,a.customCols=!1,n.push(S(t,null,!1)),a}));console.log("[func.js] Found ".concat(a.length," sheets"),a),Promise.all(n).then((function(t){for(var n=0;n<t.length;n++){var s=a[n];s.columns=t[n],a[n]=s,console.log("[func.js] Added ".concat(t[n].length," columns to ").concat(s.sheetName),a)}e(a)}))}))},C=function(e){return new Promise((function(t,n){console.log("[func.js] Revalidate Meta");var a=[],s=tableau.extensions.dashboardContent._dashboard.worksheets.map((function(t){var n=t,s=e.findIndex((function(e){return e.sheetName===n.name}));if(s>-1)return console.log("[func.js] Existing sheet ".concat(n.name," columns"),JSON.stringify(e[s].columns)),a.push(S(n,e[s].columns,!0)),e[s].existed=!0,e[s];var o={};return o.sheetName=n.name,o.selected=!1,o.changeName=null,o.customCols=!1,o.existed=!1,a.push(S(n,null,!1)),o}));console.log("[func.js] Found ".concat(s.length," sheets"),s),Promise.all(a).then((function(n){for(var a=0;a<n.length;a++){var o=s[a];o.columns=n[a],s[a]=o}s.forEach((function(t,n){if(t&&t.sheetName){var a=e.findIndex((function(e){return e.sheetName===t.sheetName}));s=function(e,t,n){if(n>=e.length)for(var a=n-e.length+1;a--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}(s,n,a)}else console.log("[func.js] Sheet ordering issue. No sheet defined in idx",n)})),console.log("[func.js] Meta revalidated",JSON.stringify(s)),t(s)}))}))},N=function(e,t,n){return new Promise((function(t,a){var s="export.xlsx";n&&n.length>0&&(s=n+".xlsx"),E(e).then((function(e){var n=p.a.write(e,{bookType:"xlsx",bookSST:!1,type:"array",ignoreEC:!1});Object(x.saveAs)(new Blob([n],{type:"application/octet-stream"}),s),t()}))}))},E=function(e){return new Promise((function(t,n){console.log("[func.js] Got Meta",e);for(var a=tableau.extensions.dashboardContent.dashboard.worksheets,s=p.a.utils.book_new(),o=0,l=0,i=[],c=[],u=[],d=0;d<e.length;d++)if(e[d]&&e[d].selected){var g=e[d].changeName||e[d].sheetName;g=g.replace(/[*?/\\[\]]/gi,""),i.push(e[d].sheetName),u.push(g),c.push(e[d].columns),o+=1}i.map((function(e,n){var i=a.find((function(t){return t.name===e}));return i.getSummaryDataAsync({ignoreSelection:!0}).then((function(e){var n=e.columns,a=c[l],i=[];a.map((function(e,t){return e&&e.selected&&i.push(e.changeName||e.name),e})),n.map((function(e,t){var s=a.find((function(t){return t.name===e.fieldName}));if(s){var o=Object(r.a)(Object(r.a)({},e),{},{selected:s.selected});return o.outputName=s.changeName||s.name,n[t]=o,o}return null})),w(n,e.data).then((function(e){console.log("[func.js] Header Order",i);var n=p.a.utils.json_to_sheet(e,{header:i}),a=u[l];l+=1,p.a.utils.book_append_sheet(s,n,a),l===o&&t(s)}))})),i}))}))},w=function(e,t){return new Promise((function(n,a){for(var s=[],o=0;o<t.length;o++)s.push(k(e,t[o]));Promise.all(s).then((function(e){n(e)}))}))},k=function(e,t){return new Promise((function(n,a){for(var s={},o=0;o<e.length;o++)if(e[o].selected){var l=void 0,i=void 0;if("%null%"===t[o].value&&null===t[o].nativeValue&&"Null"===t[o].formattedValue)l="z",i=null;else switch(e[o]._dataType){case"int":case"float":l="n",i=Number(t[o].value),isNaN(i)&&(i=t[o].formattedValue);break;case"date":case"date-time":l="s",i=t[o].formattedValue;break;case"bool":l="b",i=t[o].value;break;default:l="s",i=t[o].formattedValue}var r={v:i,t:l};s[e[o].outputName]=r}n(s)}))},H=n(220),M=n.n(H);var B=function(e){function t(){var t=tableau.extensions.settings.get("selectedSheets");if(t&&null!=t){var n=JSON.parse(t);console.log("[Extension.js] refreshSettings Existing Sheet Settings Found. Refreshing",JSON.stringify(n)),C(n).then((function(t){console.log("[Extension.js] refreshSettings settings revalidated",JSON.stringify(t)),e.updateMeta(t),e.disableButton(!1)}))}var a=tableau.extensions.settings.get("buttonLabel");a&&null!=a&&(a=a.replace(/"/g,""),console.log("[Extension.js] refreshSettings Existing Label Settings Found",a),e.updateLabel(a));var s=tableau.extensions.settings.get("buttonStyle");s&&null!=s&&(console.log("[Extension.js] refreshSettings Existing Label Style Found",s),e.updateButtonStyle(s));var o=tableau.extensions.settings.get("filename");o&&null!=o&&(console.log("[Extension.js] refreshSettings Existing Filename Found",o),e.updateFilename(o))}function n(){console.log("[Extension.js] Opening configure popup");var n="".concat(window.location.origin,"/configure");tableau.extensions.ui.displayDialogAsync(n,null,{height:500,width:500}).then((function(n){t(),console.log("[Extension.js] Config window closed",e)})).catch((function(e){switch(e.errorCode){case tableau.ErrorCodes.DialogClosedByUser:console.log("[Extension.js] Dialog was closed by user"),t();break;default:console.error("[Extension.js]",e.message)}}))}return Object(s.useEffect)((function(){console.log("[Extension.js] Props Changed",e)}),[e]),Object(s.useEffect)((function(){console.log("[Extension.js] useEffect"),tableau.extensions.initializeAsync({configure:n}).then((function(){var t=tableau.extensions.settings.get("metaVersion");t?(console.log("[Extension.js] Meta Version",t),e.updateMetaVersion(t)):(console.log("[Extension.js] Meta Version",1),t=1,e.updateMetaVersion(1));var a=tableau.extensions.settings.get("selectedSheets");a&&null!=a?(console.log("[Extension.js] Existing Sheet Settings Found",JSON.parse(a)),e.updateMeta(JSON.parse(a)),e.disableButton(!1)):(console.log("[Extension.js] Can't find existing sheet settings"),y().then((function(t){return e.updateMeta(t),O("sheets",t),O("label","Export All"),v()})).then((function(e){return n()})));var s=tableau.extensions.settings.get("buttonLabel");s&&null!=s&&(s=s.replace(/"/g,""),console.log("[Extension.js] initializeAsync Existing Label Settings Found",s),e.updateLabel(s));var o=tableau.extensions.settings.get("buttonStyle");o&&null!=o&&(console.log("[Extension.js] initializeAsync Existing Label Style Found",o),e.updateButtonStyle(o));var l=tableau.extensions.settings.get("filename");l&&null!=l&&(console.log("[Extension.js] initializeAsync Existing Filename Found",l),e.updateFilename(l))}))}),[]),Object(a.jsx)(m,{label:e.label,style:e.style,disabled:e.disabled,export:function(){var t=tableau.extensions.settings.get("selectedSheets"),n=JSON.parse(t);"server"===tableau.extensions.environment.context?N(n,0,e.filename):(console.log("[Extension.js] Tableau Version",tableau.extensions.environment.tableauVersion),M.a.compare(tableau.extensions.environment.tableauVersion,"2019.4.0",">=")?N(n,0,e.filename):function(){var e="".concat(window.location.origin,"/desktopexport");tableau.extensions.ui.displayDialogAsync(e,"",{height:350,width:400}).then((function(e){console.log("[Extension.js] Export window closed")})).catch((function(e){switch(e.errorCode){case tableau.ErrorCodes.DialogClosedByUser:console.log("[Extension.js] Export window was closed by user");break;default:console.error("[Extension.js]",e.message)}}))}())}})},F=n(225),L=n(473),T=n(18),V=n(478),D=n(475),A=n(479),I=Object(L.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},details:{alignItems:"center"},column:{flexBasis:"50%"},label:{display:"block",fontSize:12,lineHeight:"21px",order:0},group:{color:"rgba(0, 0, 0, 0.56)",display:"inline-flex",flexDirection:"column",fontFamily:"Benton Sans, Arial, Helvetica, sans-serif",position:"relative"},strikeThrough:{textDecoration:"line-through",marginRight:5,color:"rgba(156, 156, 156, 0.8)"}}})),J=Object(T.a)({root:{boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(V.a);var z=function(e){var t,n,s=I(),o={label:"Rename",onChange:function(t){return e.changeName(t.target.value)},onClear:function(){e.changeName(null)},placeholder:e.name||"Override Export Tab Name",style:{width:200},value:e.rename||""};return Object(a.jsx)("div",{className:s.root,children:Object(a.jsxs)(J,{square:!0,expanded:e.selected,children:[Object(a.jsx)(A.a,{"aria-controls":"panel1c-content",id:"panel1c-header",children:Object(a.jsx)("div",{children:Object(a.jsx)(f.Checkbox,{checked:e.selected,onChange:e.select,children:(t=e.name,n=e.rename,n?Object(a.jsxs)("div",{children:[Object(a.jsx)("span",{className:s.strikeThrough,children:t}),Object(a.jsx)("span",{children:n})]}):Object(a.jsx)("div",{children:t}))})})}),Object(a.jsxs)(D.a,{className:s.details,children:[Object(a.jsx)("div",{className:s.column,children:Object(a.jsx)(f.TextField,Object(r.a)({},o))}),Object(a.jsx)("div",{className:s.column,children:Object(a.jsxs)("div",{className:s.group,children:[Object(a.jsx)("label",{className:s.label,children:"Change Order"}),Object(a.jsx)(f.Stepper,{min:1,max:e.sheets.length,step:1,pageSteps:1,value:e.id+1,onValueChange:function(t){return e.changeOrder(t)},className:s.stepper})]})})]})]})})};var P=function(e){return e&&e.sheets?e.sheets.map((function(t,n){return Object(a.jsx)(z,{id:n,name:t.sheetName,rename:t.changeName,sheets:e.sheets,selected:t.selected,select:function(){return e.selectSheet(n)},changeName:function(t){return e.changeName(n,t)},changeOrder:function(t){return e.changeOrder(n,t)}},t.sheetName)})):Object(a.jsx)("div",{})},R=n(221),U=n.n(R),_=Object(L.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},details:{alignItems:"center"},column:{flexBasis:"50%"},label:{display:"block",fontSize:12,lineHeight:"21px",order:0},group:{color:"rgba(0, 0, 0, 0.56)",display:"inline-flex",flexDirection:"column",fontFamily:"Benton Sans, Arial, Helvetica, sans-serif",position:"relative"},strikeThrough:{textDecoration:"line-through",color:"rgba(156, 156, 156, 0.8)",marginRight:5}}})),W=Object(T.a)({root:{boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(V.a);var q=function(e){var t,n,s=_(),o={label:"Rename",onChange:function(t){return e.changeName(t.target.value)},onClear:function(){e.changeName(null)},placeholder:e.name||"Override Export Column Name",style:{width:200},value:e.rename||""};return Object(a.jsx)("div",{className:s.root,children:Object(a.jsxs)(W,{square:!0,children:[Object(a.jsx)(A.a,{expandIcon:Object(a.jsx)(U.a,{}),"aria-controls":"panel1c-content",id:"panel1c-header",children:Object(a.jsx)("div",{children:Object(a.jsx)(f.Checkbox,{checked:e.selected,onChange:e.select,children:(t=e.name,n=e.rename,n?Object(a.jsxs)("div",{children:[Object(a.jsx)("span",{className:s.strikeThrough,children:t}),Object(a.jsx)("span",{children:n})]}):Object(a.jsx)("div",{children:t}))})})}),Object(a.jsxs)(D.a,{className:s.details,children:[Object(a.jsx)("div",{className:s.column,children:Object(a.jsx)(f.TextField,Object(r.a)({},o))}),Object(a.jsx)("div",{className:s.column,children:Object(a.jsxs)("div",{className:s.group,children:[Object(a.jsx)("label",{className:s.label,children:"Change Order"}),Object(a.jsx)(f.Stepper,{min:1,max:e.cols.length,step:1,pageSteps:1,value:e.id+1,onValueChange:function(t){return e.changeOrder(t)},className:s.stepper})]})})]})]})})};var $=function(e){return e&&e.cols?e.cols.map((function(t,n){return Object(a.jsx)(q,{id:n,name:t.name,rename:t.changeName,selected:t.selected,select:function(){return e.colSelect(e.id,n)},changeName:function(t){return e.changeName(e.id,n,t)},cols:e.cols,changeOrder:function(t){return e.changeOrder(e.id,n,t)}},t.index)})):Object(a.jsx)("div",{})};var G=function(e){return e&&e.sheets?e.sheets.map((function(t,n){return t.selected?Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{children:Object(a.jsx)("b",{children:t.sheetName})}),Object(a.jsx)($,{id:n,name:t.sheetName,cols:t.columns,colSelect:e.colSelect,changeName:e.changeName,changeOrder:e.changeOrder})]},t.sheetName):Object(a.jsx)("div",{},t.sheetName)})):Object(a.jsx)("div",{})},K=n(222),Q={bottom:10,right:10,position:"fixed"},X={left:10,bottom:10,position:"fixed",color:"#4f4f4f",fontSize:12};var Y=function(e){return Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{style:X,children:["v",K.version]}),Object(a.jsxs)("div",{style:Q,children:[Object(a.jsx)(f.Button,{kind:"outline",style:{marginRight:12},onClick:e.resetSettings,children:"Reset"}),Object(a.jsx)(f.Button,{kind:"primary",style:{marginRight:12},disabled:!e.enableButton,onClick:e.save,children:"Save Changes"})]})]})},Z=n(476),ee=Object(L.a)((function(e){return{root:{flexGrow:1},gridItem:{marginTop:10}}}));var te=function(e){var t=ee(),n={label:"Button Label",onChange:function(t){console.log("[ConfigureTab.js] Updating Button Label",t.target.value),e.updateLabel(t.target.value)},onClear:function(){e.updateLabel("Export All")},placeholder:"Button Label",style:{width:400},value:e.label||""},s={label:"Export Filename",onChange:function(t){return e.updateFilename(JSON.stringify(t.target.value))},onClear:function(){e.updateFilename("ExportAll")},placeholder:"Export Filename",style:{width:400},value:e.filename||""};return Object(a.jsx)("div",{className:t.root,children:Object(a.jsxs)(Z.a,{container:!0,children:[Object(a.jsx)(Z.a,{item:!0,xs:12,children:Object(a.jsx)(f.TextField,Object(r.a)({},n))}),Object(a.jsx)(Z.a,{item:!0,xs:12,className:t.gridItem,children:Object(a.jsx)(f.TextField,Object(r.a)({},s))}),Object(a.jsx)(Z.a,{item:!0,xs:12,className:t.gridItem,children:Object(a.jsxs)(o.a.Fragment,{children:["Set Button Style to:",Object(a.jsxs)(f.DropdownSelect,{kind:"line",value:e.style,onChange:function(t){return e.updateButtonStyle(JSON.stringify(t.target.value))},style:{marginLeft:10},children:[Object(a.jsx)("option",{children:"outline"}),Object(a.jsx)("option",{children:"primary"}),Object(a.jsx)("option",{children:"destructive"})]})]})})]})})},ne=n.p+"static/media/logo.c38a9163.svg",ae=(n(452),{height:"calc(100vh - 170px)"}),se={backgroundColor:"rgb(245, 245, 245)",height:26,paddingTop:12,paddingBottom:12,paddingLeft:18};var oe=function(e){var t=Object(s.useState)(0),n=Object(F.a)(t,2),o=n[0],l=n[1];function i(e,t,n){if(n>=e.length)for(var a=n-e.length+1;a--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}return Object(s.useEffect)((function(){console.log("[Configure.js] useEffect"),tableau.extensions.initializeDialogAsync().then((function(t){console.log("[Configure.js] Initialise Dialog",t);var n=tableau.extensions.settings.get("selectedSheets");if(n&&null!=n){var a=JSON.parse(n);console.log("[Configure.js] Existing Sheet Settings Found",n),C(a).then((function(t){e.updateMeta(t)}))}var s=tableau.extensions.settings.get("buttonLabel");s&&null!=s&&(s=s.replace(/"/g,""),console.log("[Configure.js] initializeDialogAsync Existing Label Settings Found",s),e.updateLabel(s));var o=tableau.extensions.settings.get("buttonStyle");o&&null!=o&&(console.log("[Configure.js] initializeDialogAsync Existing Label Style Found",o),e.updateButtonStyle(o));var l=tableau.extensions.settings.get("filename");l&&null!=l&&(console.log("[Configure.js] initializeDialogAsync Existing Filename Found",l),e.updateFilename(l))}))}),[]),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{style:se,children:Object(a.jsx)("img",{style:{height:20},src:ne,alt:"The Information Lab"})}),Object(a.jsx)(f.Tabs,{onTabChange:function(e){l(e)},selectedTabIndex:o,tabs:[{content:"Select Sheets"},{content:"Select Columns"},{content:"Configure"}],children:Object(a.jsxs)("div",{style:ae,children:[0===o?Object(a.jsx)(P,{sheets:e.meta,selectSheet:function(t){console.log("[Configure.js] selectSheetHandler",t);var n=e.meta;n[t].selected=!n[t].selected,e.updateMeta(n),e.changeSettings(!0)},changeOrder:function(t,n){if(console.log("[Configure.js] changeSheetOrderHandler",t,n),n>0){var a=i(e.meta,t,n-1);e.updateMeta(a),e.changeSettings(!0)}},changeName:function(t,n){console.log("[Configure.js] changeSheetNameHandler",t,n);var a=e.meta;a[t].changeName=n,e.updateMeta(a),e.changeSettings(!0)}}):null,1===o?Object(a.jsx)(G,{sheets:e.meta,colSelect:function(t,n){console.log("[Configure.js] selectColumnHandler",t,n);var a=e.meta,s=a[t];s.columns[n].selected=!s.columns[n].selected,a[t]=s,e.updateMeta(a),e.changeSettings(!0)},changeName:function(t,n,a){console.log("[Configure.js] changeColumnNameHandler",t,n,a);var s=e.meta,o=s[t];o.columns[n].changeName=a,s[t]=o,e.updateMeta(s),e.changeSettings(!0)},changeOrder:function(t,n,a){if(console.log("[Configure.js] changeColumnOrderHandler",t,n,a),a>0){var s=e.meta,o=i(s[t].columns,n,a-1);o.map((function(e,t){return e.order=t,e})),s[t].columns=o,e.updateMeta(s),e.changeSettings(!0)}}}):null,2===o?Object(a.jsx)(te,{label:e.label,filename:e.filename,style:e.style,updateLabel:function(t){console.log("[Configure.js] changeUpdateLabelHandler",t),e.updateLabel(t),e.changeSettings(!0)},updateButtonStyle:function(t){console.log("[Configure.js] changeLabelStyleHandler",t),e.updateButtonStyle(t),e.changeSettings(!0)},updateFilename:function(t){console.log("[Configure.js] updateFilenameHandler",t),e.updateFilename(t),e.changeSettings(!0)}}):null]})}),Object(a.jsx)(Y,{enableButton:e.enableSave,save:function(){console.log("[Configure.js] saveSettingsHandler - Saving Settings",e);var t=e.meta,n=e.label,a=e.style,s=e.filename;e.disableButton(!1),console.log("[Configure.js] saveSettingsHandler - sheets",t),O("sheets",t).then(O("label",n)).then(O("style",a)).then(O("filename",s)).then(v()).then((function(t){console.log("[Configure.js] Saved Settings",t),e.changeSettings(!1);var n=tableau.extensions.settings.get("selectedSheets");if(n&&null!=n){var a=JSON.parse(n);console.log("[Configure.js] Sheet Settings Updated",a)}}))},resetSettings:function(){console.log("[Configure.js] resetSettingsHandler - Reset Settings"),y().then((function(t){e.updateMeta(t)}))}})]})},le=n(477);n(453);var ie=function(){return console.log("[DesktopExport.js] Initialise Export Screen"),Object(s.useEffect)((function(){console.log("[DesktopExport.js] useEffect"),tableau.extensions.initializeDialogAsync().then((function(e){console.log("[DesktopExport.js] Initialise Dialog",e);tableau.extensions.settings.get("selectedSheets")}))}),[]),Object(a.jsx)(Z.a,{container:!0,spacing:0,align:"left",justify:"center",children:Object(a.jsx)(Z.a,{item:!0,children:Object(a.jsxs)(le.a,{component:"div",style:{padding:20},children:[Object(a.jsx)("p",{children:"Hi There!"}),Object(a.jsxs)("p",{children:["It looks like you're trying to create the Excel file using a desktop version earlier than 2019.4. Unfortunately you ","can't"," as the download function is disabled, however there are two solutions. Either publish your dashboard to Server where the Excel file will download as expected, or upgrade your copy of Desktop to 2019.4 or greater."]}),Object(a.jsxs)("p",{children:["To those who've previously emailed Tableau to request they enable the download feature...we did it!! Thank you so much for taking the time to present the case, I ","can't"," believe how many emails you sent. ","I'm"," humbled."]}),Object(a.jsx)("p",{children:"Craig"})]})})})},re=(n(454),function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(e){var s;return Object(c.a)(this,n),console.log("[Main.js] new constructor"),(s=t.call(this,e)).metaVersionChangedHandler=function(e){console.log("[Main.js] Updating meta version to ".concat(e)),s.setState({metaVersion:e})},s.labelChangedHandler=function(e){console.log("[Main.js] Updating label text to ".concat(e));var t=Object(r.a)(Object(r.a)({},s.state.button),{},{label:e});s.setState({button:t})},s.filenameChangedHandler=function(e){console.log("[Main.js] Updating filename to ".concat(JSON.parse(e))),s.setState({filename:JSON.parse(e)})},s.buttonStateChangedHandler=function(e){console.log("[Main.js] Changing button state to ".concat(e));var t=Object(r.a)(Object(r.a)({},s.state.button),{},{disabled:e});s.setState({button:t})},s.buttonStyleChangedHandler=function(e){console.log("[Main.js] Changing button style to ".concat(e));var t=Object(r.a)(Object(r.a)({},s.state.button),{},{style:JSON.parse(e)});s.setState({button:t})},s.metaChangedHandler=function(e){console.log("[Main.js] Meta changed",e),s.setState({meta:e})},s.settingsChangedHandler=function(e){console.log("[Main.js] Settings changed",e),s.setState({settingsChanged:e})},s.resetSettingsHandler=function(){console.log("[Main.js] Reset Settings"),s.setState({meta:void 0,metaVersion:2,button:{label:"Export All",style:"outline",disabled:!0},isLoading:!1,filename:"ExportAll",settingsChanged:!1})},s.renderExtension=function(){return Object(a.jsx)(B,{label:s.state.button.label,meta:s.state.meta,metaVersion:s.state.metaVersion,style:s.state.button.style,filename:s.state.filename,disabled:s.state.button.disabled,updateMetaVersion:s.metaVersionChangedHandler,updateMeta:s.metaChangedHandler,disableButton:s.buttonStateChangedHandler,updateLabel:s.labelChangedHandler,updateButtonStyle:s.buttonStyleChangedHandler,updateFilename:s.filenameChangedHandler})},s.renderConfigure=function(){return Object(a.jsx)(oe,{label:s.state.button.label,meta:s.state.meta,style:s.state.button.style,filename:s.state.filename,enableSave:s.state.settingsChanged,updateMeta:s.metaChangedHandler,disableButton:s.buttonStateChangedHandler,updateLabel:s.labelChangedHandler,changeSettings:s.settingsChangedHandler,updateButtonStyle:s.buttonStyleChangedHandler,updateFilename:s.filenameChangedHandler,resetSettings:s.resetSettingsHandler})},s.renderDesktopExport=function(){return Object(a.jsx)(ie,{})},s.state={meta:void 0,metaVersion:2,button:{label:"Export All",style:"outline",disabled:!0},isLoading:!1,filename:"ExportAll",settingsChanged:!1},console.log("[Main.js] state initialised",s.state),s}return Object(u.a)(n,[{key:"componentWillMount",value:function(){console.log("[Main.js] componentWillMount")}},{key:"componentDidMount",value:function(){console.log("[Main.js] componentDidMount")}},{key:"render",value:function(){return Object(a.jsx)(h.a,{children:Object(a.jsxs)(b.c,{children:[Object(a.jsx)(b.a,{path:"/configure",children:Object(a.jsx)(oe,{label:this.state.button.label,meta:this.state.meta,style:this.state.button.style,filename:this.state.filename,enableSave:this.state.settingsChanged,updateMeta:this.metaChangedHandler,disableButton:this.buttonStateChangedHandler,updateLabel:this.labelChangedHandler,changeSettings:this.settingsChangedHandler,updateButtonStyle:this.buttonStyleChangedHandler,updateFilename:this.filenameChangedHandler,resetSettings:this.resetSettingsHandler})}),Object(a.jsx)(b.a,{path:"/desktopexport",children:Object(a.jsx)(ie,{})}),Object(a.jsx)(b.a,{path:"/",children:Object(a.jsx)(B,{label:this.state.button.label,meta:this.state.meta,metaVersion:this.state.metaVersion,style:this.state.button.style,filename:this.state.filename,disabled:this.state.button.disabled,updateMetaVersion:this.metaVersionChangedHandler,updateMeta:this.metaChangedHandler,disableButton:this.buttonStateChangedHandler,updateLabel:this.labelChangedHandler,updateButtonStyle:this.buttonStyleChangedHandler,updateFilename:this.filenameChangedHandler})})]})})}}]),n}(s.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(a.jsx)(re,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[456,1,2]]]);
//# sourceMappingURL=main.afb3ec49.chunk.js.map